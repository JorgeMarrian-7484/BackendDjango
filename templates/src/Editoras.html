{% extends 'index.html' %}
{% block contenido %}

{% if messages %}
    
    {% for msj in messages %}
        <script>
            Swal.fire('{{ msj }}','','success').then(()=>{
                window.location.href = '{{ ruta }}'
            })
        </script>
    {% endfor %}
        
{% endif %}

<h2 class="alert alert-dark text-center mt-3">{{ titulo }}</h2>
<div class="mt-3 text-end mb-3">
    <a href="{% url 'creareditora' %}" class="btn btn-success">Añadir Editora</a>
</div>
{% if editora %}
<table class="table table-bordered table-hover">
    <thead class="table-dark">
        <tr>
            <th>Nombre</th>
            <th>Pais</th>
            <th>Descripcion</th>
            <th>Logo</th>
            <th></th>
        </tr>
    </thead>
    <tbody>        
        {% for ed in editora %}
            <tr>
                <td>{{ ed.nombre }}</td>
                <td>{{ ed.pais }}</td>
                <td>{{ ed.descripcion }}</td>
                <td>
                    {% if ed.logo %}
                    <img src="/media/{{ ed.logo }}" alt="{{ ed.logo}}" width="150px">
                    {% endif %}
                </td>
                <td class="col-2 text-center">
                    <a href="{% url 'editar_editora' ed.id %}" class="btn btn-warning">Editar</a>
                    <button onclick="eliminar('{{ed.id}}')"class="btn btn-danger">Eliminar</button>
                </td>
            </tr>
        {% endfor %}            
    </tbody>
</table>

<nav aria-label="Navegación de editoras">
    <ul class="pagination justify-content-center">
        {% if editora.has_previous %}
        <li class="page-item">
            <a class="page-link" href="?page={{ editora.previous_page_number }}">Anterior</a>
        </li>
        {% else %}
        <li class="page-item disabled">
            <a class="page-link">Anterior</a>
        </li>
        {% endif %} 
        {% for num in editora.paginator.page_range %} 
        {% if editora.number == num %} 
        <li class="page-item active">
            <a class="page-link">{{ num }}</a>
        </li>
        {% elif num > editora.number|add:'-3' and num < editora.number|add:'3' %}
        <li class="page-item ">
            <a class="page-link" href="?page={{ num }}">{{ num }}</a>
        </li>
        {% endif %} 
        {% endfor %}
        
        {% if editora.has_next %}
        <li class="page-item">
            <a class="page-link" href="?page={{ editora.next_page_number }}">Siguiente</a>
        </li>
        {% else %}
        <li class="page-item disabled">
            <a class="page-link">Siguiente</a>
        </li>
        {% endif %}
    </ul>
</nav>
<script>
        const eliminar = (id) => {
        Swal.fire({
            title: "¿Estás seguro de eliminar registro?",
            text: "No podrás revertir los cambios",
            icon: "error",
            showCancelButton: true,
            confirmButtonColor: "#d33",
            cancelButtonColor: "#3085d6",
            confirmButtonText: "Eliminar"
        }).then((result) => {
            if (result.isConfirmed) {
                window.location.href = '/src/editoras/eliminar/' + id
            }
        });
    }
</script>
{% else %}
<p class="alert alert-warning">No hay Editoras registradas</p>
{% endif %}
<a href="{% url 'inicio' %}" class="btn btn-outline-dark">Volver</a>
{% endblock %}